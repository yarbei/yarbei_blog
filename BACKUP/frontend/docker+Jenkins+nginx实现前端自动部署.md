---
title: docker+Jenkins+nginxå®ç°å‰ç«¯è‡ªåŠ¨éƒ¨ç½²
author: äºšåŒ—
avatar: /images/avatar.png
categories: æŠ€æœ¯
comments: true
keywords: dockerã€Jenkinsã€Nginxã€å‰ç«¯ã€è‡ªåŠ¨éƒ¨ç½²
photos: 'https://gitee.com/yarbei/imgcloud/raw/main/202111292239974.png'
abbrlink: 2224127129
date: 2021-11-29 00:00:00
authorLink:
authorAbout:
authorDesc:
tags:
description:
---


# docker+Jenkins+nginxå®ç°å‰ç«¯è‡ªåŠ¨éƒ¨ç½²

é˜¿é‡Œäº‘åŒ11å¤§ä¿ƒä¹°äº†ä¸ªæœåŠ¡å™¨ç©ä¸€ç©

ä¹°ä¹‹å‰å¾ˆæ¿€åŠ¨ï¼Œä¹°äº†ä¹‹åï¼Œemmmmæˆ‘ç”¨å®ƒèƒ½å¹²å˜›

æ‰¾æˆ‘å¹²è¿ç»´çš„å¥½å…„å¼Ÿé—®ä¸€é—®ï¼Œå¥½å…„å¼Ÿä¹Ÿå¯¹æˆ‘æƒ³åšçš„äº‹æƒ…å¾ˆç–‘æƒ‘

![](https://cdn.yarbei.com/img/202205191107130.png)

æ‰€ä»¥æˆ‘ç¨€é‡Œç³Šæ¶‚ä¹°äº†æœåŠ¡å™¨ä½†æ˜¯å¹¶æ²¡æœ‰æƒ³å¥½ç”¨å®ƒæ¥åšä»€ä¹ˆ

å…ˆä»‹ç»ä¸€ä¸‹é…ç½®å§ï¼Œæˆ‘æ˜¯ç”¨çš„å¥³æœ‹å‹çš„è´¦å·ä¹°çš„ï¼Œé˜¿é‡Œäº‘åŒ11å¯¹æ–°äººä¼˜æƒ åŠ›åº¦æ›´å¤§

æœ€ç»ˆé€‰äº†2æ ¸4Gï¼Œ5Må¸¦å®½ï¼Œ40Gç¡¬ç›˜è¿™æ ·çš„ä¸€ä¸ªé…ç½®ï¼Œä¸€æ¬¡æ€§ä¹°äº†3å¹´ï¼Œ800å¤š

æœ‰æƒ³æ³•çš„å°ä¼™ä¼´ä¹Ÿå¯ä»¥å°è¯•ä¸€ä¸‹ï¼Œé”™è¿‡äº†åŒ11è¿˜æœ‰åŒ12å¯ä»¥çœ‹çœ‹

å¦‚æœåƒæˆ‘ä¸€æ ·ä¹°äº†ä¹‹åä¸çŸ¥é“å¹²å˜›ï¼Œå®åœ¨ä¸è¡Œè¿˜å¯ä»¥éƒ¨ç½²ä¸€ä¸‹è‡ªå·±çš„ç½‘ç«™å˜›

è¯´èµ·æ¥æˆ‘çš„åšå®¢è‡ªä»éƒ¨ç½²åœ¨giteeä¹‹åå°±æ²¡æœ‰ç„¶åäº†ã€‚ã€‚ã€‚

åšå®¢æ˜¯ç”¨hexoå†™çš„ï¼Œhexoè¿™ä¸ªä¸œè¥¿é€‚åˆæƒ³æ‹¥æœ‰è‡ªå·±çš„åšå®¢ä½†æ˜¯åˆæ²¡ä»€ä¹ˆæƒ³æ³•çš„åŒå­¦

å®ƒæä¾›äº†éå¸¸å¤šçš„ç²¾ç¾çš„æ¨¡æ¿ï¼Œå¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢çš„æ¨¡æ¿ï¼Œä¸€é”®ç”Ÿæˆè‡ªå·±çš„åšå®¢

hexoç”Ÿæˆçš„é™æ€çš„htmlé¡µé¢ï¼Œæ‰€ä»¥æˆ‘åªéœ€è¦åœ¨æœåŠ¡å™¨é…ç½®ä¸€ä¸ªNginxæœåŠ¡ï¼Œç„¶åå†æŠŠæˆ‘çš„èµ„æºæ–‡ä»¶æ‰”ä¸Šå»å°±è¡Œ

ä½†æ˜¯ï¼Œä½†æ˜¯ï¼Œå¦‚æœä»…ä»…æ˜¯è¿™æ ·æ¥éƒ¨ç½²ï¼Œé‚£ä¹Ÿå¤ªç®€å•äº†ï¼Œä¸å¦‚è®©å®ƒæ›´åŠ çš„è‡ªåŠ¨åŒ–

æ‰€ä»¥æˆ‘æƒ³è¦æ¯æ¬¡æˆ‘å¯¹æ–‡ä»¶æ›´æ”¹å®Œæˆåè®©æœåŠ¡å™¨è‡ªåŠ¨å¸®æˆ‘å®Œæˆéƒ¨ç½²çš„äº‹æƒ…ï¼Œ

è€Œä¸æ˜¯æ¯æ¬¡æ‰‹åŠ¨æ‰“åŒ…ï¼Œä¸Šä¼ ï¼Œè§£å‹ï¼Œç­‰ç­‰......

è¿™ä¸€ç³»åˆ—çš„æ“ä½œæ—¶é—´é•¿äº†é‚£å¯çœŸæ˜¯å—ä¸äº†

æ‰€ä»¥æˆ‘çš„éœ€æ±‚ä¹Ÿæ¸æ¸çš„æ¸…æ™°æ˜äº†èµ·æ¥ï¼Œè¦æœ‰Nginxï¼Œè¦èƒ½è‡ªåŠ¨éƒ¨ç½²ï¼Œå…¬å¸ç”¨çš„Jenkinsæˆ‘æ¯”è¾ƒç†Ÿæ‚‰ï¼Œè¿™ä¸€æ¬¡ä»ç„¶é€‰æ‹©å®ƒä½œä¸ºæˆ‘è‡ªåŠ¨éƒ¨ç½²çš„å·¥å…·

ä¸Šå¸è¯´è¦æœ‰å…‰ï¼Œäºæ˜¯ä¾¿æœ‰äº†å…‰ï¼Œæˆ‘æƒ³åšä¸Šå¸ï¼Œéœ€è¦æœ‰ä¸ªæ²™ç®±

>Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº [Go è¯­è¨€](https://www.runoob.com/go/go-tutorial.html) å¹¶éµä» Apache2.0 åè®®å¼€æºã€‚
Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚
å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ï¼ˆç±»ä¼¼ iPhone çš„ appï¼‰,æ›´é‡è¦çš„æ˜¯å®¹å™¨æ€§èƒ½å¼€é”€æä½ã€‚

æœ‰äº†æ²™ç®±ä¹‹åå°±å¯ä»¥æ„‰å¿«çš„åœ¨é‡Œé¢è¿›è¡Œåˆ›é€ äº†ã€‚

## ç¯å¢ƒå‡†å¤‡

- æœåŠ¡å™¨ï¼š CentOS 8
- docker
- docker-compose
- nginx é•œåƒ
- jenkins é•œåƒ
- gitee

## å®‰è£…dockerç¯å¢ƒ

1. é“¾æ¥æœåŠ¡å™¨

```shell
ssh root@000.000.000.000 #@ä½ è‡ªå·±çš„å…¬ç½‘IP
```

2. å®‰è£…å¿…è¦çš„ä¸€äº›ç³»ç»Ÿå·¥å…·

```shell
yum install -y yum-utils device-mapper-persistent-data lvm2
```

3. æ·»åŠ Docker CEçš„è½¯ä»¶æºä¿¡æ¯ã€‚

```shell

sudo yum-config-manager --add-repo \ https://download.docker.com/linux/centos/docker-ce.repo #å®¹æ˜“å¤±è´¥ï¼Œå¯ä»¥å°è¯•ä¸‹é¢è¿™ä¸ª
sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
```
4. æ›´æ–°å¹¶å®‰è£…Docker CE

```shell
sudo yum makecache fast
sudo yum -y install docker-ce
å¤åˆ¶ä»£ç 
```

5. å¯åŠ¨DockeræœåŠ¡

```shell
sudo systemctl enable docker #è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl start docker  #å¯åŠ¨docker
```
6. å®‰è£…æ ¡éªŒ

```shell
docker version  	  	 #æ˜¾ç¤ºdockerç‰ˆæœ¬ä¿¡æ¯
docker info 					 #æ˜¾ç¤ºdockerç³»ç»Ÿä¿¡æ¯
docker å‘½ä»¤ --help  	  #æŸ¥çœ‹å‘½ä»¤å¸®åŠ©
```

![](https://cdn.yarbei.com/img/202205191107131.png)

## å®‰è£…docker-compose

> docker-compose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚

1. ä¸‹è½½docker-composeï¼š

```
sudo curl -L "https://github.com/docker/compose/releases/download/1.24.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
```

2. æå‡æƒé™ï¼š

```shell
sudo chmod +x /usr/local/bin/docker-compose
```

3. æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ

```shell
docker-compose -v
```

![](https://cdn.yarbei.com/img/202205191107131.png)

## å®‰è£…Nginxå’ŒJenkinsé•œåƒ

docker æ‹‰å–Nginxå’ŒJenkinsé•œåƒå‘½ä»¤å¦‚ä¸‹ï¼š

```shell
docker pull nginx  #å®‰è£…Nginx
docker pull jenkins/jenkins:lts   #å®‰è£…Jenkins
```

å®‰è£…å®Œæˆåæ‰§è¡Œdocker imageså¯ä»¥æŸ¥çœ‹dockerä¸‹å­˜åœ¨çš„é•œåƒï¼š

![](https://cdn.yarbei.com/img/202205191107140.png)

## ç¼–å†™é…ç½®ç›®å½•

æ¥ä¸‹æ¥åˆ›å»ºé…ç½®ç›®å½•ï¼Œç»“æ„å¦‚ä¸‹ï¼š

```shell
â”œâ”€â”€ compose
â”‚Â Â  â””â”€â”€ docker-compose.yml  #docker-composeé…ç½®æ–‡ä»¶
â”œâ”€â”€ jenkins
â”‚Â Â  â””â”€â”€ jenkins_home  #JenkinsæŒ‚è½½å·
â”œâ”€â”€ nginxcfg
 Â Â  â””â”€â”€ default.conf  #Nginxé…ç½®
```

ä»¥ä¸Šç›®å½•æˆ‘æ˜¯æ”¾åœ¨æ ¹ç›®å½•ä¹‹ä¸‹çš„ï¼ŒåŒå­¦ä»¬ä¹Ÿå¯ä»¥æ”¾åœ¨è‡ªå·±å–œæ¬¢çš„ä½ç½®

## æ–‡ä»¶é…ç½®

docker-compose.ymlé…ç½®æ–‡ä»¶å†…å®¹ï¼š

```shell
version: '3'
services:                                      
  docker_jenkins:
    user: root                                
    restart: always                            
    image: jenkins/jenkins:lts                 # æŒ‡å®šæœåŠ¡æ‰€ä½¿ç”¨çš„é•œåƒ 
    container_name: jenkins                    # å®¹å™¨åç§°
    ports:                                     # å¯¹å¤–æš´éœ²çš„ç«¯å£å®šä¹‰
      - 8080:8080
      - 50000:50000
    volumes:                                   # å·æŒ‚è½½è·¯å¾„
      - /root/jenkins/jenkins_home/:/var/jenkins_home  #å†’å·å‰ä¸ºåˆšåˆšåˆ›å»ºçš„è·¯å¾„ï¼Œè¿™é‡Œè¦å†™ç»å¯¹è·¯å¾„
      - /var/run/docker.sock:/var/run/docker.sock
      - /usr/bin/docker:/usr/bin/docker                
      - /usr/local/bin/docker-compose:/usr/local/bin/docker-compose
  docker_nginx:
    restart: always
    image: nginx
    container_name: nginx
    ports:
      - 8090:80
      - 80:80
      - 433:433
    volumes:
      - /root/nginxcfg:/etc/nginx/conf.d  #ç”¨æˆ‘ä»¬åˆ›å»ºçš„Nginxé…ç½®å»æ›¿æ¢å®¹å™¨ä¸­çš„é»˜è®¤é…ç½®ï¼Œå†’å·å‰ä¸ºæˆ‘ä»¬åˆ›å»ºçš„ç›®å½•çš„è·¯å¾„
      - /root/nginxcfg/logs:/var/log/nginx  #nginxæ—¥å¿—ä½ç½®
      - /root/xxx/xxx/xxx:/usr/share/nginx/html
```

default.confæ–‡ä»¶é…ç½®

```shell
error_log  /var/log/nginx/error.log notice;
server{ # ç®€å•çš„ç›‘å¬80ç«¯å£ï¼ŒæŒ‡å®šindexä½ç½®
  listen  80;
  root /usr/share/nginx/html;
  index index.html index.htm;
}
```

åœ¨è¿™é‡Œæˆ‘è¸©äº†ä¸€ä¸ªå‘ï¼Œå°±æ˜¯ä¸æ‡‚docker-compose.ymlè¿™ä¸ªé…ç½®æ–‡ä»¶è¯¥å»æ€ä¹ˆå†™ï¼Œé‡Œé¢çš„æ¯ä¸ªå‚æ•°éƒ½æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¹Ÿæ˜¯æŸ¥äº†å¾ˆå¤šèµ„æ–™æ‰å¼„æ˜ç™½ï¼Œå…³é”®çš„æ˜¯å“ªä¸ªæŒ‚è½½å·ï¼Œvolumesè¿™ä¸ªå‚æ•°ï¼Œæˆ‘çš„ç†è§£æ˜¯ç”¨æˆ‘ä»¬çš„ä¸€ä¸ªé…ç½®å»æ›¿æ¢æ‰å®¹å™¨çš„é»˜è®¤é…ç½®ï¼Œè¿™é‡Œæˆ‘è¯·æ•™è¿‡ä¸€äº›åŒå­¦ï¼Œä»–ä»¬è¯´è¦åœ¨å¯åŠ¨dockerå®¹å™¨çš„æ—¶å€™ï¼Œç”¨dockerå‘½ä»¤å†³å®šä»¥å“ªä¸€ä¸ªé…ç½®æ¥å¯åŠ¨ï¼Œå°±ä½¿æˆ‘å¾ˆä¸ç†è§£ï¼Œè¿™ä¸ªdocker-compose.ymlæ–‡ä»¶ä¸å°±æ˜¯ç”¨æ¥åšè¿™ä¸ªäº‹æƒ…çš„å—?

æœ€ç»ˆå°è¯•äº†å¾ˆå¤šæ¬¡ä¹‹åï¼Œç»ˆäºå¼„æ˜ç™½äº†ï¼Œé—®é¢˜åœ¨volumesä¹‹ä¸‹ï¼Œå†’å·å‰é¢å†™çš„æ˜¯æˆ‘çš„é…ç½®è·¯å¾„ï¼Œå†’å·ä¹‹åçš„è·¯å¾„æ˜¯dockerå®¹å™¨å†…å„ä¸ªé•œåƒé»˜è®¤çš„é…ç½®è·¯å¾„

è¿™ä¸ªvolumeså°±æ˜¯ç”¨è‡ªå·±çš„é…ç½®å»æ›¿æ¢æ‰é»˜è®¤é…ç½®

ä¸Šè¿°ä¸¤ä¸ªæ–‡ä»¶é…ç½®å®Œæˆä¹‹åï¼Œéœ€è¦è¿›å…¥composeç›®å½•ä¸‹é¢è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ï¼š

```shell
docker-compose up -d
```

åœæ­¢ï¼š
```
docker-compose stop
```

##   Jenkinsé…ç½®

è¾“å…¥docker ps -aæŸ¥çœ‹å®¹å™¨çš„è¿è¡Œæƒ…å†µ:

![](https://cdn.yarbei.com/img/202205191107141.png)
çŠ¶æ€æ˜¾ç¤ºä¸ºup,æ­¤æ—¶åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥æœåŠ¡å™¨å…¬ç½‘IP:8080ç«¯å£å¯æ˜¾ç¤ºJenkinsç®¡ç†é¡µé¢ï¼š

![](https://cdn.yarbei.com/img/202205191107142.png)

å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥ï¼Œéœ€è¦åšä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼Œå› ä¸ºæˆ‘å·²ç»å®‰è£…è¿‡äº†ï¼Œå°±ä¸é‡æ–°å±•ç¤ºåˆå§‹åŒ–çš„è¿‡ç¨‹äº†ï¼Œå¤§æ¦‚éœ€è¦ä»¥ä¸‹æ­¥éª¤ï¼š

1. æ ¹æ®æç¤ºæ‰¾åˆ°å¯†ç å¤åˆ¶ç²˜è´´

   é€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥è·å–ï¼Œ/root/jenkins/jenkins_homeä¸ºæŒ‚è½½ç›®å½•

   cat /root/jenkins/jenkins_home/secrets/initialAdminPassword

2. å®‰è£…æ¨èçš„æ’ä»¶

3. è®¾ç½®ç®¡ç†å‘˜è´¦å·

ç„¶åå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨Jenkinsäº†



æ¥ç€ç‚¹å‡»ç³»ç»Ÿç®¡ç†->æ’ä»¶ç®¡ç†ï¼Œéœ€è¦åœ¨Jenkinså®‰è£…ä¸¤ä¸ªæ’ä»¶ï¼š

1. å®‰è£… [Publish Over SSH](https://plugins.jenkins.io/publish-over-ssh/) ä½œç”¨: å°†æ„å»ºåçš„ç¼–è¯‘äº§å‡ºå‘å¸ƒåˆ°æœåŠ¡å™¨
2. å®‰è£…[Generic Webhook Trigger Plugin](https://plugins.jenkins.io/generic-webhook-trigger/)ä½œç”¨ï¼šé€šç”¨ Webhook è§¦å‘å™¨æ„å»º

ç‚¹å‡»ç³»ç»Ÿç®¡ç†->ç³»ç»Ÿé…ç½®ï¼Œå…¨å±€é…ç½®sshï¼š

![](https://cdn.yarbei.com/img/202205191107145.png)

ç„¶ååˆ°ç³»ç»Ÿç®¡ç†->å…¨å±€å·¥å…·é…ç½®ï¼Œå®‰è£…nodejsï¼š

![](https://cdn.yarbei.com/img/202205191107146.png)

- æ³¨æ„nodeç‰ˆæœ¬ï¼Œæœ‰çš„é¡¹ç›®å¯¹nodeç‰ˆæœ¬æœ‰è¦æ±‚ï¼Œå¯èƒ½ä¼šå‡ºç°æ„å»ºä¸æˆåŠŸçš„æƒ…å†µ

## æ–°å»ºä¸€ä¸ªJenkinsæ„å»ºä»»åŠ¡

1. é€‰æ‹©æ–°å»ºä»»åŠ¡,è¾“å…¥ä»»åŠ¡åç§°ï¼Œæ„å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®ï¼š

![](https://cdn.yarbei.com/img/202205191107147.png)

2. é…ç½®æºç ç®¡ç†ï¼š

![](https://cdn.yarbei.com/img/202205191107148.png)

3. æ„å»ºè§¦å‘å™¨é…ç½®ï¼š

![](https://cdn.yarbei.com/img/202205191107149.png)

4. giteeé…ç½®webhookï¼š

![](https://cdn.yarbei.com/img/202205191107150.png)

- URLä¸ºï¼šhttp://æœåŠ¡å™¨å…¬ç½‘IP:8080/generic-webhook-trigger/invoke?token=ä½ çš„token
- é€‰æ‹©pushè§¦å‘æ„å»ºä»»åŠ¡
- è¿™é‡Œé€‰æ‹©äº†giteeï¼Œæ¯•ç«Ÿå›½å†…é€Ÿåº¦å¿«ä¸€äº›ï¼ŒGitHubçš„é…ç½®ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæºç åœ¨GitHubçš„åŒå­¦å¯ä»¥è‡ªå·±ç ”ç©¶ä¸€ä¸‹

5. æ„å»ºç¯å¢ƒé€‰æ‹©nodeï¼š

![](https://cdn.yarbei.com/img/202205191107151.png)

6. æ„å»ºï¼š

![](https://cdn.yarbei.com/img/202205191107152.png)

- å¢åŠ æ„å»ºæ­¥éª¤é€‰æ‹©æ‰§è¡Œshell

- ç¼–å†™shellè„šæœ¬

```shell
node -v  #æŸ¥çœ‹nodeï¼Œnpm ç‰ˆæœ¬
npm -v 
npm i  #npmå®‰è£…é¡¹ç›®æ‰€éœ€ä¾èµ–
npm install hexo-cli -g  #npmå®‰è£…hexo
hexo clean  #hexoæ¸…é™¤ç¼“å­˜æ–‡ä»¶å’Œé™æ€æ–‡ä»¶
hexo g  #hexoç”Ÿæˆé™æ€æ–‡ä»¶
tar -zcvf public.tar ./public  #å‹ç¼©ç”Ÿæˆçš„é™æ€æ–‡ä»¶ç›®å½•
```

- ä»¥ä¸Šshellè„šæœ¬å°±æ˜¯å…³è”çš„gitä»“åº“æœ‰äº†æ¨é€äº‹ä»¶ä¹‹åè§¦å‘çš„æ„å»ºè„šæœ¬ï¼Œä¹Ÿæ˜¯æˆ‘çš„hexoåšå®¢é¡¹ç›®æ‰€éœ€çš„æ„å»ºè¿‡ç¨‹ï¼ŒåŒå­¦ä»¬å¯ä»¥æ ¹æ®éœ€è¦ï¼Œç¼–å†™è‡ªå·±é¡¹ç›®çš„æ„å»ºè„šæœ¬

7. æ„å»ºåæ“ä½œï¼š

![](https://cdn.yarbei.com/img/202205191107153.png)

- æ„å»ºåæ“ä½œé€‰æ‹©send build artifacts over SSH
- å¡«å†™è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶åç§°ï¼ˆåœ¨æ„å»ºè„šæœ¬æœ€åä¸€å¥ï¼štar -zcvf public.tar ./publicï¼‰
- å¡«å†™ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„è·¯å¾„ï¼ˆè¿™é‡Œçš„è·¯å¾„æ˜¯ä»¥Jenkinsé…ç½® [Publish Over SSH](https://plugins.jenkins.io/publish-over-ssh/) æ’ä»¶æ—¶çš„é‚£ä¸ªè·¯å¾„ä¸ºæ ¹ç›®å½•çš„ï¼Œæœ€ç»ˆçš„è·¯å¾„ä¸ºdocker-compose.ymlä¸­é…ç½®çš„Nginxä¸‹rootç›®å½•ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘å†™çš„æ˜¯/yarbei/apps,ä¸Šä¼ æ–‡ä»¶çš„å®é™…çš„å®é™…è·¯å¾„ä¸º/root/yarbei/apps/public.tarï¼Œrootç›®å½•ä¸º/root/yarbei/apps/yarbeiwebï¼Œä¹‹åpublic.tarè§£å‹æ›¿æ¢yarbeiweb)
- ç¼–å†™æ–‡ä»¶ä¸Šä¼ åçš„è„šæœ¬

```shell
cd /root/yarbei/apps  #è¿›å…¥æ–‡ä»¶æ‰€åœ¨ç›®å½•
mv yarbeiweb yarbeiweb-$(date +%Y%m%d-%H%M) #å°†æ—§çš„æ–‡ä»¶å¤¹æ›´åå¤‡ä»½
tar zxvf public.tar  #è§£å‹public.tar
mv public yarbeiweb  #å°†è§£å‹åçš„æ–‡ä»¶å¤¹æ”¹å
rm -rf public.tar  #åˆ é™¤å‹ç¼©åŒ…
```

è‡³æ­¤ï¼ŒåŸºäºdocker+Jenkins+Nginxå®ç°çš„å‰ç«¯è‡ªåŠ¨éƒ¨ç½²åŠŸèƒ½å°±å®ç°äº†

![](https://cdn.yarbei.com/img/202205191107154.png)

## å°ç»“

å…¶å®è¿™æ¬¡çš„æŠ˜è…¾æ˜¯å±äºæ„æ–™ä¹‹å¤–çš„ï¼ŒæºäºåŒåä¸€çš„ä¸€æ¬¡å†²åŠ¨æ¶ˆè´¹ï¼Œä¸è¿‡ç»è¿‡ä¸€ç•ªæŠ˜è…¾ä¹Ÿç®—æœ‰äº†ä¸€äº›æ”¶è·ï¼Œä½œä¸ºä¸€ä¸ªå‰ç«¯å·¥ç¨‹å¸ˆï¼Œæˆ‘å¯¹æœåŠ¡å™¨ã€è¿ç»´æ–¹é¢çš„çŸ¥è¯†å‚¨å¤‡æ˜¯æ¯”è¾ƒå°‘çš„ï¼ŒæœŸé—´èµ°äº†ä¸å°‘å¼¯è·¯ï¼Œæ¯”å¦‚è·¯å¾„é—®é¢˜ï¼Œdocker-composeçš„é…ç½®é—®é¢˜ï¼Œåœ¨æ–‡ä¸­éƒ½æœ‰ä½“ç°ã€‚è‡³äºä¸ºä»€ä¹ˆæ˜¯dockerï¼Œå¯èƒ½ä¹Ÿæ˜¯å¯¹Linuxå‘½ä»¤è¡Œçš„æ“ä½œæ–¹å¼äº†è§£è¾ƒå°‘ï¼Œä¸æƒ³å› ä¸ºè‡ªå·±æ“ä½œå¤±è¯¯æœ€ç»ˆè®©æ•´ä¸ªç¯å¢ƒä¹±é­ç³Ÿï¼Œåˆ°æœ€ç»ˆä¸å¯æ§ã€‚ä½¿ç”¨dockerä¸ä»…èƒ½å¿«é€Ÿå®æ–½ï¼Œè€Œä¸”èƒ½éš”ç¦»ç¯å¢ƒï¼Œé¿å…ç¯å¢ƒä¾èµ–ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡æˆ‘è‡ªå·±çš„æœåŠ¡å™¨è®¿é—®åšå®¢äº†ï¼ŒåŸŸåæ­£åœ¨å¤‡æ¡ˆä¸­ğŸ˜‚ğŸ˜‚

æœ¬æ¬¡éƒ¨ç½²å¤§æ¦‚æ­¥éª¤å¦‚ä¸‹ï¼š

1. å‡†å¤‡ç¯å¢ƒ
2. å®‰è£…docker
3. å®‰è£…docker-compose
4. å®‰è£…Jenkinså’ŒNginx
5. ç¼–å†™é…ç½®æ–‡ä»¶
6. é…ç½®Jenkins
7. é…ç½®Jenkinsæ„å»ºä»»åŠ¡

## å‚è€ƒèµ„æ–™

- [å°ç™½éƒ½èƒ½çœ‹æ‡‚çš„å‰ç«¯éƒ¨ç½²ï¼ˆdocker+nginx+jenkinsï¼‰ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6844904111826010125#heading-7)
- [é…ç½®é¡¹ç›®æ„å»ºå®Œæˆåæ–‡ä»¶ç§»åŠ¨---- Jenkinsè‡ªåŠ¨åŒ–éƒ¨ç½²å­¦ä¹ ç¬”è®°ï¼ˆä¸‰ï¼‰ - ç®€ä¹¦ (jianshu.com)](https://www.jianshu.com/p/ca07a19d036a)
- [Jenkinsè®¾ç½®æŒ‡å®šè·¯å¾„çš„source fileè¿›è¡ŒSSHä¼ è¾“ç®¡ç†_fan_hahaçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/fan_haha/article/details/110224311)


